window.jQuery||alert("Sorry! Your browser is super outdated, and might have viruses. Please upgrade to Firefox, Chrome, or a newer version of IE - immediately."),function($){function t(t,i){e[t]||(e[t]=$(t).html());var s=$("<div>"+e[t]+"</div>");for(var n in i)s.find(".class-"+n).addClass(i[n]),s.find(".href-"+n).attr("href",i[n]),s.find(".src-"+n).attr("src",i[n]),s.find(".target-"+n).attr("target",i[n]),s.find(".text-"+n).text(i[n]);return s.children()}var e={};$.template=t}(jQuery);var photoCloud={submissions:[],processing:!1,processed:0,limit:500,page:0,nodeCount:0,thumbSize:60,rows:10,centerOffset:null,bubbleWidth:250,bubblePopDelay:300,bubblePopTimer:null,stopRandomBubble:!1,bubbleRandomInterval:5e3,xhr:!1,$el:$("#wall-scroller"),init:function(){this.centerOffset=this.$el.offset(),$("section.wall").css("height",this.rows*this.thumbSize+"px"),this.load(function(){for(var t=0;t<this.submissions.length;t++)this.newNode(this.submissions[t]);this.nodeCount=this.processed}.bind(this)),this.$el.on("click","a",function(t){return t.preventDefault(),!1;this.submissions[t.target.id.substr(7)].link&&window.open(this.sanitize(this.submissions[t.target.id.substr(7)].link))}.bind(this)),this.$el.on("mouseover","a",function(t){this.stopRandomBubble=!0,this.showBubble(t.target.id.substr(7))}.bind(this)),this.$el.on("mouseout","a",function(t){this.stopRandomBubble=!1,this.hideBubbles()}.bind(this)),setInterval(this.showRandomBubble.bind(this),this.bubbleRandomInterval)},load:function(t){this.processing=!0,this.xhr&&this.xhr.abort(),this.xhr=$.ajax({url:"//participants.battleforthenet.com/participants",data:"limit="+this.limit+"&skip="+this.page*this.limit,dataType:"json",type:"get",success:function(e){this.page++,this.processing=!1,this.submissions=this.submissions.concat(e),0==e.length&&(console.log("OMG EMPTY - starting over"),this.processed=0,this.page=0),t()}.bind(this)})},loadMore:function(t){t||(t=0),this.stopRandomBubble=!0;for(var e=function(t,e){setTimeout(function(){this.replaceNode(t,e),t>=this.nodeCount-1&&(this.stopRandomBubble=!1)}.bind(this),10*t)}.bind(this),i=t;i<this.nodeCount;i++){if(!(this.processed+i<this.submissions.length-1))return console.log("STARVED - need to get more people: ",this.submissions.length),this.load(function(){this.loadMore(i)}.bind(this));e(i,this.submissions[this.processed+i])}},newNode:function(t){var e=5e3,i=function(t,i,s){setTimeout(function(){this.loadImageAndDoCallback(this.sanitize(i.avatar.replace("http:","")),i._id,function(){this.insertNodeElement(t,i,s)}.bind(this))}.bind(this),Math.floor(Math.random()*e))}.bind(this),s=this.getOffsetsByIndex(this.processed);s.OUT_OF_BOUNDS||(i(this.processed,t,s),this.processed++)},replaceNode:function(t,e){var i=this.getOffsetsByIndex(t);i.OUT_OF_BOUNDS||(this.loadImageAndDoCallback(this.sanitize(e.avatar.replace("http:","")),e._id,function(){$("#avatar_"+t).css("opacity",0),$("#bubble_"+t).css("opacity",0),$("#pointy_"+t).css("opacity",0),setTimeout(function(){$("#avatar_"+t).remove(),$("#bubble_"+t).remove(),$("#pointy_"+t).remove(),this.insertNodeElement(t,e,i)}.bind(this),1e3)}.bind(this)),this.processed++)},loadImageAndDoCallback:function(t,e,i){var s=new Image;s.src=t,s.onload=i,s.onerror=function(){-1!=t.indexOf("twimg.com")&&this.reportBrokenImage(e),i()}.bind(this)},insertNodeElement:function(t,e,i){var s=$("<a/>",{id:"avatar_"+t,"class":e.link?"":"",style:"left:"+i.left+"px;               top:"+i.top+"px;               width:"+this.thumbSize+"px;               height:"+this.thumbSize+"px;               background-image: url("+this.sanitize(e.avatar.replace("http:",""))+");               background-size: "+this.thumbSize+"px auto;"});s.attr({href:"#",target:"_blank"}),s.appendTo(this.$el),setTimeout(function(){s.css("opacity",1)},10);var n=i.left-this.bubbleWidth/2+this.thumbSize/2,o=-1*i.top+this.thumbSize+14;n+this.centerOffset.left<10?n=-1*this.centerOffset.left+10:n+this.bubbleWidth>this.centerOffset.left+this.thumbSize/2&&(n=this.centerOffset.left-this.bubbleWidth+this.thumbSize/2+8);var a=$("<div/>",{id:"bubble_"+t,"class":"bubble",style:"left:"+n+"px;               bottom:"+o+"px;               width:"+this.bubbleWidth+"px;"});a.html("<strong>"+this.sanitize(e.blurb)+"</strong><span "+(e.link?"":"")+">"+this.sanitize(e.name)+"</span>"),a.appendTo(this.$el);var r=i.left+this.thumbSize/2,l=i.top-26;r+this.centerOffset.left<33?r=-1*this.centerOffset.left+33:r>this.centerOffset.left&&(r=this.centerOffset.left+15);var c=$("<div/>",{id:"pointy_"+t,"class":"arrow",style:"left:"+r+"px;               top:"+l+"px;"});c.appendTo(this.$el)},showRandomBubble:function(){if(this.stopRandomBubble)return!1;var t=this.$el.find("a"),e=Math.floor(Math.random()*t.length);this.showBubble(e)},hideBubbles:function(){this.bubblePopTimer&&clearTimeout(this.bubblePopTimer),this.bubblePopTimer=null,this.$el.find("a").removeClass("hovered"),$("div.arrow").css("opacity",0),$("div.bubble").css("opacity",0)},showBubble:function(t){this.hideBubbles(),this.bubblePopTimer=setTimeout(function(){$("#avatar_"+t).addClass("hovered"),$("#bubble_"+t).css("opacity",1),$("#pointy_"+t).css("opacity",1)},this.bubblePopDelay)},getOffsetsByIndex:function(t){var e,i,s,n=this.thumbSize;t%2==1?(e=1,s=(t-1)/2%this.rows,i=Math.floor((t-1)/2/this.rows)+1):(e=-1,s=t/2%this.rows,i=Math.floor(t/2/this.rows)+1);var o={left:e*i*n-n/2*e,top:s*n};return this.centerOffset.left+o.left+this.thumbSize<0&&(o.OUT_OF_BOUNDS=!0),o},sanitize:function(t){return t=t.replace(/\</g,"&lt;"),t=t.replace(/javascript\:/g,"java script -"),t=t.replace(/shit/gi,"$#!@"),t=t.replace(/fuck/gi,"@!#&")},reportBrokenImage:function(t){}},loaded_wall=!1;!function($){function t(t){var e=!0,s={};return i.forEach(function(i){$("input[name="+i+"]",t)[0]&&""===$("input[name="+i+"]",t).val()?e=!1:s[i]=$("input[name="+i+"]",t).val()}),s.action_comment=$("[name=action_comment]").val(),s.country=$("#country").val(),s.org=window.org,e&&$.ajax({url:"//queue.battleforthenet.com/submit",type:"post",dataType:"json",data:s,success:function(t){userID=t.userID}}),e}function e(){var t=-1;if("Microsoft Internet Explorer"==navigator.appName){var e=navigator.userAgent,i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=i.exec(e)&&(t=parseFloat(RegExp.$1))}return t}$.ajax({url:"//fftf-geocoder.herokuapp.com/",dataType:"json",type:"get",success:function(t){t.country&&t.country.iso_code&&($("#country").val(t.country.iso_code),"US"!=t.country.iso_code&&$(".form .note").html("Net neutrality matters. <strong>Everywhere.</strong>"))}}),$("a.break").length&&($("a.break").click(function(t){t.preventDefault(),window.open($("a.break").attr("href"))}),setTimeout(function(){$("a.break").css("opacity",1)},2e3)),-1!=window.location.href.indexOf("#PARTICIPANT")&&$("#participantModal").modal("show"),$("a.share.facebook").click(function(t){t.preventDefault(),$("#sp_fb a").click()}),$("a.share.twitter").click(function(t){t.preventDefault(),$("#sp_tw a").click()}),$(".wall-under .columns .show_all a").click(function(t){t.preventDefault(),$(".wall-under .columns").removeClass("obscured");var e=0;$(".wall-under .columns > div").each(function(){var t=$(this).innerHeight();t>e&&(e=t)}),$(".wall-under .columns > div.listing").each(function(){$(this).css("height",e+"px")}),$(".wall-under .columns").animate({height:e+"px"},1e3,function(){})}),$(".faqs .columns .show_all a").click(function(t){console.log("clicked"+this),$(".faqs .columns").removeClass("obscured");var e=0;$(".faqs .columns > div").each(function(){var t=$(this).innerHeight();t>e&&(e=t)}),$(".faqs .columns > div.listing").each(function(){$(this).css("height",e+"px")}),$(".faqs .columns").animate({height:e+"px"},1e3,function(){})}),$(".questions-answers .columns .show_all a").click(function(t){console.log("clicked"+this),$(".questions-answers .columns").removeClass("obscured");var e=0;$(".questions-answers .columns > div").each(function(){var t=$(this).innerHeight();t>e&&(e=t)}),$(".questions-answers .columns > div.listing").each(function(){$(this).css("height",e+"px")}),$(".questions-answers .columns").animate({height:e+"px"},1e3,function(){})}),$(".myths .columns .show_all a").click(function(t){console.log("clicked"+this),$(".myths .columns").removeClass("obscured");var e=0;$(".myths .columns > div").each(function(){var t=$(this).innerHeight();t>e&&(e=t)}),$(".myths .columns > div.listing").each(function(){$(this).css("height",e+"px")}),$(".myths .columns").animate({height:e+"px"},1e3,function(){})}),$(".letter-under .columns .show_all a").click(function(t){console.log("clicked"+this),$(".letter-under .columns").removeClass("obscured");var e=0;$(".letter-under .columns > div").each(function(){var t=$(this).innerHeight();t>e&&(e=t)}),$(".letter-under .columns > div.listing").each(function(){$(this).css("height",e+"px")}),$(".letter-under .columns").animate({height:e+"px"},1e3,function(){})});var i=["action_comment","address1","email","name","zip"];if($("form textarea").on("focus",function(t){$(this).blur()}),$("a").each(function(t){$(this).attr("href")&&$(this).attr("href").match(/^#/)&&$(this).on("click",function(t){if(!this.href.match(/#home/)){t.preventDefault();var e="#"+this.href.split("#")[1];$(e).velocity("scroll",{duration:777,offset:-66},function(){location.hash=e})}})}),$(window).on("hashchange",function(){var t=$("#navigation a");t.removeClass("selected");var e=location.hash||"#home",i=t.filter("[href="+e+"]");0===i.length&&(i=t.first()),i.addClass("selected")}).trigger("hashchange"),$("#editModal .modal-footer button").on("click",function(t){t.preventDefault();var e=$("#editModal textarea").val();$("#what-to-do form textarea").val(e),$("#editModal").modal("hide")}),$("form[name=petition]").submit(function(e){e.preventDefault(),t($(this))?(window.cachedData=$("#what-to-do form").serialize(),$("input:not([type=image],[type=button],[type=submit])").val(""),$("body").hasClass("embed")?$("#thanksModal").modal("show"):$("#participantModal").modal("show")):alert("Please complete the rest of the form. Thanks!")}),window.authSuccess=function(){var t=$("#participant_form").serialize(),e=window.cachedData+"&"+t;$.ajax({url:"//api.battleforthenet.com/participant/create",type:"post",xhrFields:{withCredentials:!0},data:e,success:function(t){$("#participantModal").modal("hide"),$("#thanksModal").modal("show")}})},window.authFailure=function(){},$("#participantModal .modal-footer").on("click",function(t){var e=$(this).find("a").attr("disabled");e&&(t.preventDefault(),$("#participant_link").focus(),$("#participant_link").select())}),window.org="",Math.random()<.2&&($(".call-to-action").addClass("fp"),window.org="fp"),navigator.userAgent.match("MSIE")){$(".modal.fade").removeClass("fade");var s=e();10>s&&($("body").addClass("oldie"),$("input, textarea").placeholder())}$(".listing").length&&$.ajax({url:"//participants.battleforthenet.com/participants/listed",dataType:"json",type:"get",success:function(t){for(var e=t.length-1;e>=0;e--)if(t[e].listing){var i=$("<li/>",{id:"listing_"+t[e]._id}),s="<span>"+photoCloud.sanitize(t[e].name)+"</span>";t[e].link&&(s='<a href="'+photoCloud.sanitize(t[e].link)+'" target="_blank">'+photoCloud.sanitize(t[e].name)+"</a>"),i.html(s),i.appendTo($(".listing."+t[e].listing+" ul"))}}}),setTimeout(function(){if(window.countUp){var t=44e5,e=80603,i=451387,s=new countUp("animated-count",t,t+e+i,0,5.87);s.start()}},2500)}(jQuery);